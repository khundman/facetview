import csv
import re
import distance
from operator import itemgetter

wd = "/users/hundman/documents/data_science/hyspiri_search/facetview-hyspiri-public/agu/"

# curl -XDELETE 'http://search-hyspiri-usewpxxqltz2vmfgyqg2zglosi.us-west-2.es.amazonaws.com/agu_2015'
# curl -XPOST http://search-hyspiri-usewpxxqltz2vmfgyqg2zglosi.us-west-2.es.amazonaws.com/agu_2015 --data-binary @/users/hundman/documents/data_science/hyspiri_search/facetview-hyspiri-public/agu/abstract_map2
# curl -s -XPOST search-hyspiri-usewpxxqltz2vmfgyqg2zglosi.us-west-2.es.amazonaws.com/_bulk --data-binary @/users/hundman/documents/data_science/hyspiri_search/facetview-hyspiri-public/agu/index_split1

# \n(?!(\s)*\{(\s)*\")
# \d{5}\" \} \}\n\{ \"index
#(?<!\} \})\n(?!\{ \"index)
# (?<!\:)\"(?!(\s)*\}|\, "|(\s)*\:|(\s)*\:(\s)*\"|index|_index|agu_|_type|type1|_id|\d\d\d\d\d|authors|title|abstract)

# "jyr-ching hu", "yun chen"

# "geology", "earthquake", "gps", "remote sensing", "radar", "tectonic", "seismic", "model"
# "land surface", "ecology", "desertification", "remote sensing", "geology", "land cover", "photosynthesis", "carbon exchange"

solid_earth = ["sergey samsonov::canada center for remote sensing","eric fielding::jet propulsion lab caltech","paul tapponnier::nanyang technological university","roland burgmann::university of california berkeley","mong-han huang::nasa jet propulsion laboratory","mark simons::california institute of technology","lujia feng::earth observatory of singapore","ke zhang::university of oklahoma norman campus","diego melgar::university of california berkeley","zacharie duputel::institut de physique du globe de strasbourg","yu-ming yang::nasa jet propulsion laboratory","yu wang::eos","yehuda bock::university of california san diego","yajing liu::mcgill university","xing meng::jet propulsion laboratory","xiaowei chen::university of oklahoma norman campus","wulin qu::gucas graduate university of chinese academy of sciences","wu-lung chang::national central university","takashi okuda::nagoya university","sylvain barbot::earth observatory of singapore","stephanie prejean::usgs volcano disaster assistance program","shinichiro horikawa::nagoya university","ryota hino::tohoku university","richard langley::university of new brunswick","richard forster::university of utah","richard allen::university of california berkeley","randall white::usgs","qiang qiu::nanyang technological university","pierdavide coisson::institut de physique du globe de paris","philippe lognonne::institut de physique du globe de paris","peter lafemina::he pennsylvania state university","paul moorcroft::harvard university","paul lundgren::nasa jet propulsion laboratory","paul bates::university of bristol","paramesh banerjee::nanyang technological university","olga verkhoglyadova::nasa jet propulsion laboratory","marcos moreno::helmholtz centre potsdam gfz german research centre for geosciences","luther strayer::california state university east bay","luis rivera::institut de physique du globe de strasbourg","kristy tiampo::university of western ontario","kerry sieh::nanyang technological university","kenjiro matsuhiro::nagoya university","junle jiang::california institute of technology","judith hubbard::nanyang technological university","jonathan makela::university of illinois","jingyi chen::stanford university","jing liu::institute of geology, china earthquake administration","jianghui geng::university of california san diego","jeffrey neal::university of bristol","ingo grevemeyer::geomar helmholtz centre for ocean research kiel","haylee dickinson::purdue university","guoqing sun::university of maryland college park","giovanni occhipinti::institut de physique du globe de paris","gen li::university of southern california","francisco nunez-cornu::university of guadalajara","felipe escalona::sisvoc","emma hill::nanyang technological university","duncan agnew::university of california san diego","daniel scott::harvard university","chung-pai chang::national central university","chung-pai chang::center for space and remote sensing research, national central university","chung-han chan::nanyang technological university","charles werner::gamma remote sensing","charles huyck::imagecat, inc.","charles ammon::pennsylvania state university main campus","ayoola abimbola::california state university east bay","attila komjathy::nasa jet propulsion laboratory","ashehad ali::harvard university","anthony mannucci::jet propulsion laboratory","andrew hooper::university of leeds","andrew freed::purdue university","adrian mcevilly::california state university east bay","aaron wech::alaska volcano observatory","zvi ben-avraham::university of haifa","zongchao li::institute of geophysics, china eathquake administration","ziyadin cakir::istanbul technical university","zhongbo su::university of twente","zhong lu::southern methodist university","zhiyu zhang::radi institute of remote sensing and digital earth, chinese academy of sciences","zhiwei li::institute of geodesy & geophysics","zhiqiang chen::university of missouri kansas city","zhiming bai::institute of geology and geophysics, chinese academy of sciences","zhigang peng::georgia institute of technology main campus","zhi wang::cas chinese academy of sciences","zhenxing yao::institute of geology and geophysics cas","zhenghui hu::imagecat, inc.","zhen wang::earthquake research institute, university of tokyo","zhen liu::igg institute of geology and geophysics, chinese academy of sciences","zenshiro saito::tokyo institute of technology","zaisen jiang::institute of earthquake sciencechina earthquake administration","zacharie duputel::cnrs","yuval levy::san diego state university","yuta maeda::nagoya university","yusaku ohta::tohoku university","yuri fialko::university of california san diego","yun zhou::institute of tibetan plateau research, chinese academy of sciences","yun chen::institute of geology and geophysics, chinese academy of sciences","yukihito osada::tohoku university","yuka namiki::kyoto university","yuebing wang::cea china earthquake administration","yuchan yi::ohio state university main campus","yuanyuan jia::ohio state university main campus","yuan min cai::department of geoscience, national taiwan university","yu-lien yeh::graduate institute of seismology national chung cheng university","yu-chang chan::academia sinica","younghee kim::seoul national university","yoshiko yamanaka::g.s. of environmental studies","yoshihiro hiramatsu::kanazawa university","yong zheng::institute of geodesy & geophysics","yoichi murashima::kkc","yohei hamada::jamstec japan agency for marine-earth science and technology","ylona van dinther::eth swiss federal institute of technology zurich","yisi li::cea china earthquake administration","yiren yuan::igp institute of geophysics, china earthquake administration","yijian zeng::university of twente","yifang cheng::university of oklahoma norman campus","yicun guo::itag institute of theoretical and applied geophysics, peking university","yi-zen chang::ncree national center for research on earthquake engineering of taiwan","yi-ying wen::graduate institute of seismology national chung cheng university","yi-heng li::itri industrial technology reseach institute","yen-yu lin::institute of earth sciences academia sinica","yen-che liao::itri industrial technology reseach institute","yasuo ogawa::tokyo institute of technology","yasuhiro kumahara::hiroshima university","yaolin shi::ucas university of chinese academy of sciences","yanqiang wu::first crust monitoring and application center, china earthquake administration","yann klinger::institut de physique du globe de paris","yang shen::univ rhode island","yang hong::university of oklahoma norman campus","yan zhan::university of illinois at urbana champaign","xuhua shi::earth observatory of singapore","xueliang chen::institute of geophysics, china eathquake administration","xiwei xu::institute of geology, china earthquake administration","xingxing li::helmholtz centre potsdam gfz german research centre for geosciences","xinfu li::china university of geosciences","xiaoling wu::monash university","xiaogang he::princeton university","xiaofeng meng::georgia institute of technology main campus","xiaofeng liang::institute of geology and geophysics, chinese academy of sciences","xiaobo tian::institute of geology and geophysics, chinese academy of sciences","xianwu xue::the university of oklahoma","xiankang zhang::geophysical exploration center, china earthquake administration","xiangteng wang::institute of geodesy & geophysics ucas university of chinese academy of sciences","xi-bin tan::institute of geology, china earthquake administration","xi zhang::igg institute of geology and geophysics, chinese academy of sciences","wouter immerzeel::utrecht university","wouter dorigo::vienna university of technology","wonheung kim::yonsei university","william holt::stony brook university","william foxall::lawrence berkeley national laboratory","william ellsworth::stanford university","willem schreuder::principia mathematica","weston thelen::hawaiian volcano observatory","wesley danskin::usgs california water science center san diego","wenyuan fan::scripps institution of oceanography","wenjian ni::radi institute of remote sensing and digital earth, chinese academy of sciences","wendy mccausland::u.s.geological survey","weisen shen::university of colorado at boulder","weimin wang::institute of tibetan plateau research, chinese academy of sciences","wei zhou::colorado school of mines","wataru nakamura::tohoku university japan meteorological agency","warner marzocchi::national institute of geophysics and volcanology","wanpeng feng::institute of geophysics china earthquake administration","wang yizhou::institute of geology, china earthquake administration","vladimir lyakhovsky::geological survey isreal","viswanathan bringi::colorado state university","virgile rakoto::institut de physique du globe de paris","virendra ghate::argonne national laboratory","vipul silwal::university of alaska fairbanks","vincent onana::nasa goddard space flight center","vincent drouin::university of iceland","victor tsai::california institute of technology","victor cruz-atienza::universidad nacional autonoma de mexico","viacheslav kharuk::v.n.sukachev institute of forest sb ras","vernon cormier::univ connecticut","venkataraman lakshmi::university of south carolina","veena patel::stanford earth sciences","vanessa markwitz::university of western australia","valerie ballu::university of la rochelle","valeria becerra-carreno::university of chile","valenti sallares::institute of marine sciences - csis","vadim monteiller::geoazur - universite nice sophia antipolis","vaclav vavrycuk::academy of sciences of the czech republic","uwe ring::stockholm university","ugur dogan::yildiz technical university","tuan sy le::national central university","tsutomu sasatani::hokkaido university","tracy rowlandson::university of guelph","toshiko terakawa::nagoya university","tolga gorum::yildiz technical university","todd caldwell::university of texas at austin","tobias diehl::eth swiss federal institute of technology zurich","tiphaine tallec::centre d'etudes spatiales de la biosphere","ting-yu liu::national central university","ting yuan::university of houston","timothy james::swansea univeristy","timothy ahern::iris data management center","tim wright::university of leeds","tim o'farrell::university of sheffield","tim bauge::thales uk","tiefei li::institute of geophysics, china eathquake administration","tianhaozhe sun::university of victoria","thorsten wagener::university of bristol","thordis hognadottir::university of iceland","thora arnadottir::university of iceland","thomas walter::helmholtz centre potsdam gfz german research centre for geosciences","thomas stanley::universities space research association greenbelt","thomas rockwell::san diego state university","thomas jordan::southern california earthquake center","thomas jackson::usda ars","thomas hearn::new mexico state university","thomas brocher::u.s. geological survey","thierry pellarin::lthe laboratoire d'etude des transferts en hydrologie et environnement","tetsuo takanami::carnegie inst washington","teruyuki kato::earthquake research institute, university of tokyo","tavi murray::glaciology group, swansea university","tatsuya ishiyama::earthquake research institute, university of tokyo","taro uchida::sabo planning division, national institute for land and infrastructure management, japan","taras gerya::eth swiss federal institute of technology zurich","tao xu::igg institute of geology and geophysics, chinese academy of sciences","tania insua::ocean networks canada","tamlin pavelsky::university of north carolina at chapel hill","talal alharbi::king saud university","takuya nishimura::kyoto university","takuya inoue::kokusai kogyo co., ltd","takeshi sagiya::nagoya university","takeshi iinuma::japan agency for marine-earth science and technology","takaya iwasaki::university of tokyo","takashi nakata::hiroshima university","takahiro hatano::university of tokyo","taiping xie::college of politics,tongling university","tai-lin tseng::ntu national taiwan university","sylvain mangiarotti::centre d'etudes spatiales de la biosphere","sydney le cras::california polytechnic state university san luis obispo","swapnamita choudhury::wadia institute of himalayan geology","sushil kumar::wadia institute of himalayan geology","susanna ebmeier::university of bristol","susan owen::nasa jet propulsion laboratory","susan owen::jet propulsion laboratory","susan hoover::usgs","sudhir rajaure::tribuvan university","subeg bijukchhen::hokkaido university","stephane operto::geoazur","stuart thomson::university of arizona","stuart edwards::newcastle university","strong wen::ncree national center for research on earthquake engineering of taiwan","stine skrunes::uit the arctic university of norway","steven wesnousky::nevada seismological lab center for neotectonic studies","steven walsh::univ connecticut","steven roecker::rensselaer polytechnic institute","steven chan::jet propulsion laboratory, california institute of technology","steven arcone::us army engineer research and development","stephen nesbitt::university of illinois at urbana champaign","stephen beller::geoazur","stephen angster::center for neotectonic studies nevada seismological lab","stephanie dumont::university of iceland","stephan sobolev::helmholtz centre potsdam gfz german research centre for geosciences","stefano lorito::national institute of geophysics and volcanology","stefan wiemer::eth zurich","stefan buske::tu bergakademie freiberg","sridhar anandakrishnan::pennsylvania state university","sorvigenaleon ildefonso::earth observatory of singapore","soma sapkota::national seismological centre","slaven begovic::icm-csic","sin-mei wu::department of geoscience, national taiwan university","simone lolli::nasa goddard space flight center","simon yueh::jet propulsion laboratory, california institute of technology","simon mcclusky::anu","simon klemperer::stanford university","simon johnson::geological survey of western australia","silvio seno::university of pavia","silvan ragettli::eth swiss federal institute of technology zurich","sigurlaug hjaltadottir::university of iceland","sigurjon jonsson::king abdullah university of science and technology","sigrun hreinsdottir::gns science","sidhanth kothari::university of western ontario","siddhesh naik::university of colorado at boulder","shurun tan::university of michigan ann arbor","shunichi koshimura::tohoku university","shuichi kodaira::jamstec japan agency for marine-earth science and technology","shubhasmita biswal::indian institute of technology, kharagpur","shu-huei hung::ntu national taiwan university","shou-hao chiang::ncu national central university of taiwan","shiyong zhou::peking university","shingo watada::earthquake research institute, university of tokyo","shin-chan han::university of newcastle","shenjian zhang::itag institute of theoretical and applied geophysics, peking university","shaokun si::national deep sea center, state oceanic administration","shannon graham::harvard university","seungbum kim::jet propulsion laboratory, california institute of technology","seth moran::usgs central region offices denver","sergio barrientos::university of chile","sergio aguilar::unam national autonomous university of mexico","sergey matrosov::university of colorado","sergei lebedev::dublin institute for advanced studies","seong soo yum::yonsei university","semih ergintav::bogazici university","selwyn sacks::carnegie inst washington","selver senturk::istanbul technical univ","seda cetin::yildiz technical university","sebastian simonsen::dtu space, national space institute","sebastian riquelme::university of chile","sebastian horning::university of stuttgart","sebastian heimann::helmholtz centre potsdam gfz german research centre for geosciences","sebastiaan luyssaert::cea saclay dsm / lsce","sean solomon::lamont-doherty earth observatory, columbia university","sean gulick::university of texas at austin","scott palo::university of colorado at boulder","scott ellis::university corporation for atmospheric research","scott callaghan::university of southern california","saurabh baruah::csir-north east institute of science & technology","satoshi miura::tohoku university","sascha kempf::laboratory for atmospheric and space physics","sarah minson::u.s. geological survey","santiago aguaiza::escuela politecnica nacional","samuel corgne::university of rennes 2","sally macintyre::university of california santa barbara","ryan smith::stanford university","ryan gold::usgs geologic hazards science center","ryan cassotto::university of new hampshire main campus","ruth murdie::geological survey of western australia","rosemary knight::stanford university","ronni grapenthin::new mexico institute of mining and technology","ronald eguchi::imagecat, inc.","romain jolivet::ecole normale superieure paris","rogier van der velde::university of twente","roger denlinger::usgs","roger bilham::university of colorado","rodrigo paiva::byrd polar research center","rodolfo console::integrated geomorphology center for the mediterranean area (cgiam)","robin aspey::university of sheffield","roberto torres::servicio geologico colombiano pasto","robert washington-allen::university of tennessee","robert smith::univ utah-geology & geophysics","robert smalley::univ memphis","robert shcherbakov::university of western ontario","robert pattison::usda forest service","robert pappalardo::jet propulsion laboratory, california institute of technology","robert mccoy::university of alaska fairbanks","robert mccaffrey::portland state university","robert hawman::univ georgia","robert harris::oregon state university","robert granat::nasa jet propulsion laboratory","robert chen::columbia university of new york","robert chen::columbia university","rob govers::utrecht university","risheng chu::institute of geodesy & geophysics","richard walters::university of leeds","richard briggs::us geological survey","richard aster::colorado state university","riccardo lanari::irea","rhiannon vieceli::pennsylvania state university main campus","rene forsberg::technical university of denmark - space","renaud hostache::luxembourg institute of science and technology","ray wells::u.s. geological survey","ray weldon::university of oregon","rakia meister::technical university of denmark - space","rajat bindlish::usda ars","raffaele castaldo::cnr institute for the electromagnetic sensing of the environment","rafael almeida::earth observatory of singapore","r. scott dunbar::jet propulsion laboratory, california institute of technology","r. jayangondaperumal::wadia institute of himalayan geology","quiriat gutierrez::university of guadalajara","quiriart gutierrez pena::university of guadalajara","qingju wu::igp institute of geophysics, china earthquake administration","qiang xu::itp institute of tibetan plateau research, chinese academy of sciences","qi li::institute of geology, china earthquake administration","qi guo::ohio state university main campus","pradeep srivastava::wadia institute of himalayan geology","piyush agram::nasa jet propulsion laboratory","piyush agram::jet propulsion laboratory","pietro tizzani::cnr institute for the electromagnetic sensing of the environment","pierre todoroff::cirad","pierre sakic::university of la rochelle","pierre jeanne::lawrence berkeley national laboratory","phyo maung maung::department of meteorology and hydrology","philippe ciais::cnrs","philip maechling::southern california earthquake center","philip kraaijenbrink::utrecht university","philip christensen::arizona state university","peter shearer::university of california san diego","peter molnar::university of colorado at boulder","peter haeussler::usgs alaska science center","percy galvez::aecom aecom","peisang tsai::university corporation for atmospheric research","peggy o'neill::nasa goddard space flight center","pedro elosegui::csic massachusetts institute of technology","pedro barbosa::instituto nacional de pesquisas da amazonia (inpa)","paula burgi::earth observatory of singapore","paula aguirre::pontifical catholic university of chile","paul tregoning::australian national university","paul somerville::aecom","paul rydelek::carnegie inst washington","paul montesano::science systems and applications, inc.","paul montesano::nasa goddard space flight center","paul mann::university of houston","paul mai::king abdullah university of science and technology","paul jarrin::instituto geofisico, escuela politecnica nacional","paul gosselin::butte county department of water and resource conservation","paul denys::university of otago","paul bedrosian::usgs","patrick meunier::ens","patrick matgen::luxembourg institute of science and technology","patrick kennedy::colorado state university","patricia mothes::instituto geofisico","patricia gregg::university of illinois at urbana champaign","patrice cappelaere::vightel corporation","pascal buri::eth swiss federal institute of technology zurich","pascal audet::university of ottawa","paolo ferrazzoli::university of rome tor vergata","paolo di girolamo::universita della basilicata","paola montone::national institute of geophysics and volcanology","pamela roselli::national institute of geophysics and volcanology","pall einarsson::university of iceland","pablo gonzalez::university of leeds","p. fang::scripps institution of oceanography","oyvind breivik::norwegian meteorological institute","oscar cadena::servicio geologico colombiano pasto","omar perez::simon bolivar university","olivia miller::university of utah","odin marc::deutsches geoforschungszentrum gfz","nori nakata::stanford university","nobuo takai::hokkaido university","nobuhisa matsuta::nagoya university","nikolai vasilenko::institute of marine geology and geophysics feb ras","niels hovius::gfz german research centre for geosciences","nicole mcmahon::colorado state university","nick van de giesen::delft university of technology","nick selmes::glaciology group, swansea university","nicholas schmerr::university of maryland college park","nicholas schmerr::university of maryland","nicholas rainville::university of colorado at boulder","neal driscoll::scripps institution of oceanog","nathan pugh::trimble navigation, inc.","nathan kurtz::nasa goddard space flight center","nathalie garcia millan::sisvoc","narendra das::jet propulsion laboratory, california institute of technology","naoko teratani::nagoya university","naoki uchida::tohoku university","nadine reitman::usgs geologic hazards science center","nadav wetzler::university of california santa cruz","myo thant::university of yangon","mustapha meghraoui::eost cole et observatoire des sciences de la terre","mustafa emil::western michigan university","motoyuki kido::tohoku university","morgan moschetti::usgs central region offices denver","monica kohler::california institute of technology","molly anderson::boise state university","mohamed sultan::western michigan university","mohamed ahmed::western michigan university","mohamed abdelsalam::oklahoma state university main campus","mitsuhiro oda::hokuriku electric power co., ltd.","minoru ikehara::university of kochi","ming-che hsieh::sinotech engineering consultants","milton ordonez::colombian geological service","mikki osterloo::university of colorado at boulder","mikhail kogan::columbia university of new york","mike sullivan::colorado division of water resources","mike stults::incorporated research institutions for seismology","mike james::university of lancaster","mick van fossen::iris data management center","michinobu kuwae::ehime university","michiko shigefuji::institute of seismology and volcanology, hokkaido university","michelle parks::university of iceland","michele greco::university of basilicata","michele fitzpatrick::univ connecticut","michal rosenthal::geological survey isreal","michael studinger::nasa goddard space flight center","michael spencer::jet propulsion laboratory, california institute of technology","michael schwartz::argonne national laboratory","michael rybakov::geological survey isreal","michael ritzwoller::univ colorado","michael riedel::geomar helmholtz centre for ocean research kiel","michael moore::geoscience australia","michael hren::university of connecticut","michael hartnady::university of cape town","michael durand::ohio st univ-earth sciences","michael dentith::university of western australia","michael cosh::usda ars","michael cleveland::los alamos national laboratory","michael bevis::ohio state university","merhala thurai::colorado state university","meredith nettles::columbia university of new york","mercedes salvia::instituto de astronomia y fisica del espacio (conicet/uba)","mengtan gao::institute of geophysics, china eathquake administration","melissa wood::luxembourg institute of science and technology university of bristol","melissa mcgrath::seti institute mountain view southwest research institute","melanie drilleau::institut de physique du globe de paris","mehdi nikkhoo::helmholtz centre potsdam gfz german research centre for geosciences","megh dhital::tribuvan university","mayuko shimizu::jaea japan atomic energy agency","maurizio mattesini::complutense university of madrid","maurizio battaglia::usgs baltimore","maureen walton::university of texas at austin","massimo chiappini::ist nazionale geofisica","masayoshi ichiyanagi::institute of seismology and volcanology, hokkaido university","masashi ushioda::geological survey of japan, aist","masaoki uno::tohoku university","masanobu yamamoto::hokkaido university","masanao shinohara::university of tokyo","masahiro ichiki::tohoku university","masaaki mishina::tohoku university","masaaki hamada::kanazawa university","mary scruggs::california department of water resources","marvin lilley::univ washington","martin hensch::icelandic met office","marta carranza::complutense university of madrid","marouane temimi::noaa-crest/city college, cuny","marlon pierce::indiana university bloomington","mark yoder::university of california","mark simons::seismological laboratory, division of geological and planetary sciences, california institute of technology","mark seyfried::usda - ars","mark petersen::denver federal center","mark fahnestock::university of alaska fairbanks","mario ruiz::escuela politecnica nacional","mario aranha::university of california berkeley","mariette vreugdenhil::vienna university of technology","mariano gonzalez-roglich::duke university","maria teresa mariucci::national institute of geophysics and volcanology","margaret glasscoe::nasa jet propulsion laboratory","margaret boettcher::university of new hampshire main campus","marco yepez::instituto geofisico","marco chini::luxembourg institute of science and technology","marco calo::unam national autonomous university of mexico","marco bagnardi::university of leeds","marc thibeault::conae","marc hesse::university of texas at austin","maorong ge::helmholtz centre potsdam gfz german research centre for geosciences","manabu hashimoto::kyoto university","mahta moghaddam::university of southern california","mahesh parija::wadia institute of himalayan geology","magnus gudmundsson::university of iceland","maeva pourpoint::pennsylvania state university main campus","mac cathles::university of michigan","ma.carolina valderas::university of chile","lynn montgomery::university of maryland college park","luyuan huang::ucas university of chinese academy of sciences","luis dalguer::swissnuclear","lucy flesch::purdue university","lucie rolland::geoazur - universite nice sophia antipolis","lucie rolland::geoazur","lucia trivigno::integrated geomorphology center for the mediterranean area (cgiam)","louise sandberg sorensen::dtu space","louise prockter::applied physics laboratory johns hopkins","louise kellogg::university of california - davis","lorenzo bonini::university of trieste","lora koenig::national snow and ice data center","longbin ouyang::china univ. of geosciences(bj)","lisa grant ludwig::university of california irvine","lionel le mezo::cirad","lili feng::university of colorado at boulder","lijuan he::igg institute of geology and geophysics, chinese academy of sciences","liang zheng::grad univ chinese acad sci","liang zhao::igg institute of geology and geophysics, chinese academy of sciences","laurel rand-lewis::harvard-westlake high school","laurel goodell::princeton university","laura giustarini::luxembourg institute of science and technology (list)","lara wagner::carnegie institution for science washington","lan dang::jet propulsion laboratory, california institute of technology","laetitia le pourhiet::univ paris 06 cnrs umr7193","kurt retherford::southwest research institute","kuo-hsin tseng::national central university","kuo-fong ma::ncu national central university of taiwan","kuan-hsiang chen::department of geoscience, national taiwan university","kristine larson::university of colorado at boulder","kristin vogfjord::icelandic meteorological office","kristin jonsdottir::icelandic meteorological office","koichiro obana::jamstec japan agency for marine-earth science and technology","kohtaro ujiie::university of tsukuba","klaus gessner::organization not listed","klaus gessner::geological survey of western australia","klaus bataille::universidad de concepcion","kiyoshi suyehiro::jamstec japan agency for marine-earth science and technology","kiya riverman::pennsylvania state university main campus","kirill khvorostovsky::nansen environmental and remote sensing center","kimmo rautiainen::finnish meteorological institute","kimberly mccormack::university of texas at austin","khaled khelfi::ipgp - institut de physiqye du globe de paris","kevin hand::jet propulsion laboratory","kerry sieh::eos","keren dai::school of civil engineering and geosciences newcastle university","kenneth ranson::nasa goddard space flight center","kenneth creager::applied physics laboratory university of washington","ken ikehara::marine geology research group","kelly caylor::princeton university","kelin wang::geological survey of canada sidney","kejie chen::helmholtz centre potsdam gfz german research centre for geosciences","keitaro yamada::kyoto university","keiji takemura::kyoto univ","kefeng zhu::ohio state university main campus","kazushige obara::earthquake research institute, university of tokyo","karsten spaans::university of leeds","karen fischer::brown university","karen bemis::rutgers university","karan vahi::usc information sciences inst.","kang wang::university of california san diego","kang li::institute of geology, china earthquake administration","kai deng::mcgill university","jyun-bin chen::national central university","jyr-ching hu::national taiwan university","justin burton::emory university","juntao cai::","junmeng zhao::itp institute of tibetan plateau research, chinese academy of sciences","junle jiang::seismological laboratory, division of geological and planetary sciences, california institute of technology","jun wang::indiana university bloomington","jun kameda::the university of tokyo","juliet biggs::university of bristol","julien denize::agrocampus ouest university of rennes 2","julia singer::eth swiss federal institute of technology zurich","judith ramos::universidad nacional autonoma de mexico","juanjo danobeitia::cmima-csic","juan martin::pontifical catholic university of chile","juan carlos baez::universidad de chile","juan baez::centro sismologico national, universidad de chile","jouni pulliainen::finnish meteorological institute","jothiram vivekanandan::university corporation for atmospheric research","joseph westlake::jhuapl","joseph shea::international center for integrated mountain development","jose martinez-fernandez::university of salamanca","jose manuel martinez solares::instituto geografico nacional","jose borges::university of evora","jorge vasquez::pontifical catholic university of chile","jorge jara::isterre institute of earth sciences","jonathon barichivich::cea saclay dsm / lsce","jonathan lunine::cornell university","jonathan gourley::national severe storms lab","jonas ruh::university pierre and marie curie paris vi","jon ranson::nasa goddard space flight center","john spencer::southwest research institute","john sonntag::aecom","john simmons::columbia university of new york","john shaw::harvard university","john rundle::university of california","john melack::university of california santa barbara","john lyons::alaska volcano observatory - usgs","john loveless::smith college","john langbein::us geological survey","john elliott::university of oxford","john clinton::eth swiss federal institute of technology zurich","john brett::geological survey of western australia","johann diener::university of cape town","joao amaral::instituto nacional de pesquisas da amazonia (inpa)","joanne chan::california state university east bay","joan gomberg::us geological survey","joachim genrich::california institute of technology","jiwen teng::institute of geology and geophysics, chinese academy of sciences","jiuxun yin::ustc university of science and technology of china","jinping guo::institute of geophysics, china eathquake administration","jinlai hao::institute geology & geophysics","jing zhao::cenc china earthquake networks center","jin tan::geological exploration technologies institute of anhui province,","jieyuan ning::peking university","jiatie pan::cea china earthquake administration","jianbao sun::institute of geology, china earthquake administration","jhe-syuan lai::national central university","jessie saunders::scripps institution of oceanography","jesse hutchinson::university of victoria","jerome van der woerd::university of strasbourg","jeremy pesicek::usgs volcano disaster assistance program","jeremy harbeck::adnet systems inc. greenbelt","jennifer swenson::duke university","jennifer haase::ucsd","jeffrey walker::monash university","jeffrey freymueller::university of alaska fairbanks","jeff bayless::aecom","jeanne sauber::nasa goddard sfc","jean-yves royer::univ. brest / cnrs","jean-philippe avouac::university of cambridge","jean-philippe avouac::california institute of technology","jean-paul ampuero::california institute of technology","jean-mathieu nocquet::geoazur - universie nice sophia antipolis","jean-francois dejoux::centre d'etudes spatiales de la biosphere","jean-bernard de chabalier::institut de physique du globe de paris","jay wellik::usgs volcano disaster assistance program","jay parker::nasa jet propulsion laboratory","jason soderblom::massachusetts institute of technology","jascha polet::california state polytechnic university pomona","jamie farrell::univ utah-geology & geophysics","james yungel::aecom","james o'neil::university of maine","james ni::new mexico state university main campus","james headen::elizabeth city state university","jakub fedorik::university of pavia","jakob steiner::eth swiss federal institute of technology zurich","jacqueline salzer::deutsches geoforschungszentrum gfz","jack waite::southwest research institute san antonio","j bruce shyu::national taiwan university","iwan hermawan::earth observatory of singapore","ivonne arroyo::geomar helmholtz centre for ocean research kiel","ittai kurzon::geological survey isreal","ismael ortega::universidad de chile","iskander muldashev::gfz german research centre for geosciences","isabel suhr::lewis & clark college","ian rutt::swansea university","ian pierce::center for neotectonic studies and nevada seismological laboratory","ian martin::newcastle university","ian adams::us naval research laboratory","hyongki lee::university of houston","huajian yao::ustc university of science and technology of china","huaiyu yuan::macquarie university","huai zhang::gucas graduate university of chinese academy of sciences","howard zebker::stanford university","hossein hashemi::stanford university","honn kao::geological survey canada","hongyi li::china univ. of geosciences(bj)","hongfeng yang::chinese university of hong kong","hongbing liu::itp institute of tibetan plateau research, chinese academy of sciences","hisashi suito::gsi of japan","hiroyuki yamaguchi::natural consultant co., ltd.","hiroshi yarai::gsi of japan","hiroshi sato::university of tokyo","hiroshi ichihara::jamstec","hiroo kanamori::seismological laboratory, division of geological and planetary sciences, california institute of technology","hiroaki kobayashi::tohoku university","hildur frioriksdottir::icelandic meteorological office","hideomi gokon::the university of tokyo","heng zhang::itp institute of tibetan plateau research, chinese academy of sciences","helena buurman::university of alaska fairbanks","helen piete::univ. brest / cnrs","hector parra::instituto geografico militar","hector mora-paez::ingeominas","heather mcnairn::agriculture and agri-food canada","hayrullah karabulut::bogazici university","haydee karszenbaum::instituto de astronomia y fisica del espacio (conicet/uba)","hans-peter marshall::boise state university","hans-erik andersen::usda forest service pacific northwest research station","hans thybo::university of copenhagen","hannes bathke::king abdullah university of science and technology","hannah marshall::colorado college","han yue::california institute of technology","halldor geirsson::european center for geodynamics and seismology he pennsylvania state university","hala aljassar::kuwait university","haiqiang lan::institute of geology and geophysics, chinese academy of sciences","hahn chul jung::nasa goddard space flight center","hadis samadi alinia::university of western ontario","hadi ghofrani::university of western ontario","gyorgy hetenyi::eth swiss federal institute of technology zurich","gwo-jong huang::colorado state university","guust nolet::geoazur","gunnar guomundsson::icelandic met office","gulsen ucarkus::scripps institute of oceanography","guiting hou::peking university","guihua chen::institute of geology, china earthquake administration","guido cervone::pennsylvania state university main campus","guangzhe liu::college of forestry ,northwest a&f university,college of forestry","guangyu xu::rutgers university new brunswick","guangcai feng::central south university","guan-ting liu::center for space and remote sensing research national central university","grigory steblov::institute of physics of the earth ras","gregory yetman::columbia university","gregory yetman::center for international earth science information network","gregory lyzenga::nasa jet propulsion laboratory","gregory hoke::syracuse university","gregory beroza::stanford university","greg mcfarquhar::university of illinois at urbana champaign","graham kent::university of nevada reno","goran ekstrom::lamont-doherty earth observatory of columbia university","gong deng::itp institute of tibetan plateau research, chinese academy of sciences","glen mattioli::unavco, inc. boulder","giuseppe foti::national oceanography centre","giovanni zeni::irea-cnr","giovanni toscani::university of pavia","giovanni corato::luxembourg institute of science and technology","gideon juve::usc information sciences inst.","gerardo suarez::unam national autonomous university of mexico","george spence::university of victoria","george priest::retired volunteer, oregon dept. of geology and mineral industries","george duffy::university of illinois at urbana champaign","george allen::university of north carolina at chapel hill","georg stadler::ut austin","georg niedrist::eur.ac","geoffrey collins::wheaton college","geoff cromwell::usgs california water science center san diego","gennadii donchyts::deltares","gengpei lin::national central university","ge li::mcgill university","gavin schrock::seattle public utilities","gaku kimura::university of tokyo","gail atkinson::university of western ontario","g keller::university of oklahoma","fuan tsai::national central university","freysteinn sigmundsson::university of iceland","frederick pollitz::usgs california water science center menlo park","franck audemard::funvisis","francisco ortega::university of chile","francisco ortega-culaciati::university of chile","francisco grings::instituto de astronomia y fisica del espacio","francisco bravo::university of chile","francis nimmo::university of california santa cruz","francesca pellicciotti::eth zurich","florent aden-antoniow::institut de physique du globe de paris","fiachra o'loughlin::university of bristol","feng bao::institute of geodesy and geophysics","felice ponzo::university of basilicata","fedor baart::deltares","federico filipponi::institute for environmental protection and the environmental research","fang huang::igp institute of geophysics, china earthquake administration","fan-chi lin::university of utah","fabrizio romano::national institute of geophysics and volcanology","fabienne maignan::cea saclay dsm / lsce","eyjlfur magnsson::university of iceland","ewa deelman::usc information sciences inst.","evin fetkovich::oklahoma state university main campus","evan miles::scott polar research institute","eva smith::grinnell college","eugenie perouse::california institute of technology","estella atekwana::oklahoma state university main campus","esayas shume::jet propulsion laboratory","esayas gebremichael::western michigan university","ernesto lopez-baeza::university of valencia","erik sturkell::university of gothenburg","eric sandvol::university of missouri columbia","eric lberich::freiberg university of mining and technology","eric lindsey::scripps institution of oceanography","eric fielding::jet propulsion laboratory","eric daub::center for earthquake research and information","eric ceschia::centre d'etudes spatiales de la biosphere","erchie wang::igg institute of geology and geophysics, chinese academy of sciences","eni njoku::jet propulsion laboratory, california institute of technology","emma myers::western washington university university of washington seattle campus","emilie klein::ecole normale superieure paris","emilie joetzjer::montana state university","emiliana valentini::institute for environmental protection and the environmental research","emile okal::northwestern university","emanuele lodolo::national institute of oceanography and applied geophysics ogs","elvira astafyeva::institut de physique du globe de paris","ellsworth welton::nasa goddard space flight center","elizabeth turtle::applied physics laboratory johns hopkins","elizabeth trejo::sisvoc","elise kali::cnrs ipgs","elisa buforn::complutense university of madrid","eliot atekwana::oklahoma state university main campus","elias heimisson::stanford university","elias deeb::crrel u.s. army cold regions research and engineering laboratory","eileen evans::usgs geological survey","edward kim::nasa goddard space flight center","edward beighley::northeastern university","eduardo contreras-reyes::university of chile","eduard kissling::eth swiss federal institute of technology zurich","edmundo norabuena::organization not listed","e burov::university pierre and marie curie paris vi","douglas wiens::washington university in st louis","douglas solomon::university of utah","douglas parker::school of earth and environment, university of leeds","douglas morton::nasa goddard space flight center","douglas alsdorf::ohio state university main campus","dou kang::peking university","donghui yi::stinger ghaffarian technologies greenbelt","donald turcotte::university of california davis","donald blankenship::university of texas at austin","donald argus::jpl","do hyuk kang::nasa goddard space flight center","dmitry frolov::ioffe physical-technical institute ras","dj martin::usgs california water science center san diego","dipendra gautam::tribhuvan university","dino bellugi::massachusetts institute of technology","diego gomez::servicio geolgico colombiano pasto","diego barba::complutense university of madrid","diana nunez::universidad de guadalajara","diana comte::university of chile","diana blaney::jet propulsion laboratory","deepak chamlagain::tribhuvan university","deborah smith::carnegie inst washington","dayanthie weeraratne::california state university northridge","dawei gao::university of victoria","david senske::nasa jet propulsion laboratory","david petley::university of durham","david milledge::university of durham","david mencin::unavco, inc. boulder","david eaton::university of calgary","david butterfield::university of washington/noaa/pmel","david bekaert::university of leeds","dave may::eth swiss federal institute of technology zurich","dara goldberg::scripps institution of oceanography","dara entekhabi::massachusetts institute of technology","danny feucht::university of colorado at boulder","daniel dzurisin::usgs cascades volcano observatory","daniel cayan::university of california san diego","daniel carrizo::university of chile","daniel bowden::california institute of technology","dana caccamise::the ohio state university noaa national geodetic survey","dan zheng::china univ. of geosciences(bj)","damian walwer::ecole normale suprieure paris","dalia kirschbaum::nasa goddard space flight center","cunren liang::jet propulsion laboratory","cristian lpez::colombian geological service","craig weaver::usgs","corinne bachmann::lawrence berkeley national laboratory","clment mige::university of utah","claudia notarnicola::eur.ac","clara daniels::georgia institute of technology main campus","cintia bruscantini::instituto de astronoma y fsica del espacio","chunquan wu::university of memphis","chung-yen kuo::national cheng kung university","chung-pai chang::center for space and remote sensing research","chun-chin wang::national central university","christopher sanborn::univ connecticut","christopher duross::usgs geologic hazards science center","christopher andronicos::purdue univ","christophe vigny::ens/cnrs","christophe vigny::cnrs","christodoulos kyriakopoulos::university of california riverside","christine regalla::boston university","christine puskas::unavco, inc. boulder","christine gommenginger::national oceanography centre","christina buck::butte county department of water and resource conservation","christian escudero::university of guadalajara","chris rollins::california institute of technology","chris pearson::university of otago","chris paranicas::applied physics laboratory johns hopkins","chris marone::penn state univ","chris goldfinger::oregon state university","chieh-hung chen::ccu national chung cheng university","chiara casarotti::eucentre foundation, european centre for training and research in earthquake engineering","chi-yu chiu::central weather bureau","chi ao::nasa / jet propulsion laboratory","cheryl cameron::state of alaska","chengping chai::pennsylvania state university main campus","charles mueller::usgs - golden","changqing sun::institute of crustal dynamics, china earthquake administration","changli yao::china university of geosicences(beijing)","chad trabant::iris data management center","chad babcock::university of washington seattle campus","cesar ranero::icm-csic","cathleen jones::nasa jet propulsion laboratory","catherine alexandrakis::freiberg university of mining and technology","catalina fortuno::pontifical catholic university of chile","casper pranger::eth zurich","carsten montzka::forschungszentrum jlich","carolynne hultquist::pennsylvania state university main campus","carolyn glockhoff::san diego association of geologists","carol raymond::nasa jet propulsion laboratory","carol paty::georgia inst. of technology","carmen pro::universidad de extremadura","carmala garzione::university of rochester","carlos oliveira::universidade de lisboa","carl tape::university of alaska fairbanks","camilla brekke::uit the arctic university of norway","cameron kleinkort::colorado state university","cahyadi nur cahyadi::geodesy and surveying laboratory","cagil karakas::earth observatory of singapore","c.k. shum::ohio state university main campus","c.k. shum::ohio state university","burns cheadle::university of western ontario","bryan riel::seismological laboratory, division of geological and planetary sciences, california institute of technology","bryan riel::california institute of technology","bruce forsberg::instituto nacional de pesquisas da amaznia (inpa)","bruce cook::nasa goddard space flight center","brian wernicke::california institute of technology","brett baker::santa clara valley water district","brendan meade::harvard university","branislav notaros::colorado state university","bor-shouh huang::academia sinica","biyun guo::1.college of marine science and technology,zhejiang ocean university, zhoushan, china ;2.state key laboratory of hydroscience and engineering,tsinghua university","bishal upreti::tribhuvan university","bert jagers::deltares","benjamin poulter::montana state university","benjamin lowry::colorado school of mines","benjamin larson::noaa seattle","benjamin holt::nasa jet propulsion laboratory","benedikt ofeigsson::icelandic meteorological office","ben baker::instrumental software technologies, inc.","belay demoz::howard university","bei zhang::university of chinese academy of sciences","baptiste gombert::institut de physique du globe de strasbourg","aurlien bablet::institut de physique du globe de paris","aurelie coudurier curveur::earth observatory of singapore","atsushi suzuki::tokyo institute of technology","asuka yamaguchi::university of tokyo","asta rut hjartardottir::university of iceland","arthur van dam::deltares","arthur delorme::institut de physique du globe de paris","arianna morelli::eucentre foundation, european centre for training and research in earthquake engineering","antonio pepe::cnr institute for the electromagnetic sensing of the environment","antonio colangelo::geocart spa","antonella cirella::national institute of geophysics and volcanology","anne socquet::isterre institute of earth sciences","anne sheehan::university of colorado at boulder","anne rosinski::california geological survey menlo park","anne paul::isterre institute of earth sciences","anna pacheco::agriculture and agri-food canada (aafc)","anna foster::earth observatory of singapore","angelyn moore::nasa jet propulsion laboratory","angelyn moore::jet propulsion laboratory, california institute of technology","angelo cio::integrated geomorphology center for the mediterranean area (cgiam)","angela hawkins::university of california davis","angel gonzales-zamora::university of salamanca","anfu niu::cenc china earthquake networks center","andrey babeyko::helmholtz centre potsdam gfz german research centre for geosciences","andrew schaeffer::university of ottawa","andrew newman::university corporation for atmospheric research","andrew newman::georgia institute of technology main campus","andrew michael::usgs western regional offices menlo park","andrew lamb::u.s. geological survey","andrew katumwehe::oklahoma state university main campus","andrew goodwillie::lamont-doherty earth observ","andrew finley::michigan state university","andreas fichtner::eth swiss federal institute of technology zurich","andreas colliander::jet propulsion laboratory, california institute of technology","andrea taramelli::eucentre foundation, european centre for training and research in earthquake engineering institute for environmental protection and the environmental research"]

dict = {}
# {author: [affil, count]}

with open(wd + "author_names.csv", "rU") as raw:
	reader = csv.reader(raw)
	for row in reader:
		paper_authors = row[0].split(";")
		for auth in paper_authors:
			found_affil = True
			affil = ""
			author_loc = 0
			
			try:
				author_loc = re.search(auth.strip(),row[1]).end()
			except:
				try:
					auth_trim = re.search("\w+, \w+",auth).group(0)
					author_loc = re.search(auth_trim,row[1]).end()
				except:
					try:
						auth_last = re.search("\w+",auth).group(0)
						author_loc = re.search(auth_last,row[1]).end()
					except:
						found_affil = False

			if found_affil == True:
				affil_area = row[1][author_loc:]
				try:
					start = re.search("\]", affil_area).end()
					end = re.search("\[", affil_area).end()
					affil = affil_area[start:end-1].strip().replace(";","")
				except:
					start = re.search("\]", affil_area).end()
					affil = affil_area[start:].strip()
				
				auth = auth.strip().lower()
				if auth in dict:
					affil1 = dict[auth.lower()][0].split()
					affil2 = affil.split()

					matches = 0
					for x in affil1:
						if x in affil2:
							matches += 1

					if distance.jaccard(dict[auth][0], affil) < .35 or matches > 3:
						dict[auth.lower()][1] += 1
					elif len(affil1) > 0 and len(affil2) > 0 and affil1[len(affil1)-1] == affil2[len(affil2)-1]:	
						dict[auth.lower()][1] += 1
						dict[auth.lower()][2] += 1
					else:
						try: 
							dict[auth.lower() + "2"][1] += 1
						except:
							dict[auth.lower() + "2"] = ["",0,""]
							dict[auth.lower() + "2"][0] = affil.lower()	
							dict[auth.lower() + "2"][1] = 1
						# print "mismatch for " + auth + ": " + dict[auth][0] + "  &  " + affil
						# print distance.jaccard(dict[auth][0], affil)
						# print affil1
						# print affil2
						# print ""
						# pass

				else:
					dict[auth.lower()] = ["",0,""]
					dict[auth.lower()][0] = affil.lower()
					dict[auth.lower()][1] = 1
					dict[auth.lower()][2] = 1
# for key, value in dict.iteritems():
# 	if value[1] > 3:
# 		print key + ":  " + str(value)

ruled_out = ['chen, yy', 'chen, y2', 'chen, j2', 'yin, jy', 'zhang, xl']

auths_added = []
used = []
topten = []
for j in range(0,40):
	topten.append(["","",0])
for value in solid_earth:
	name = value.split("::")[0]
	affil = value.split("::")[1]
	last_name = name.split()[len(name.split())-1]
	first_name = name.split()[0]
	matching_form = last_name + ", " + first_name
	# print matching_form
	for key2, value2 in dict.iteritems():
		# print "AGU author: " + matching_form
		# print "Beacon auth: " + key2 + "  " + str(value2)
		# last = 
		if last_name == key2.split(",")[0] and first_name[0] in key2.split(",")[1].strip()[0] and value2[1] > 1:
			print "AGU author: " + matching_form + "  [" + str(affil)
			print "Match: " + key2 + "  " + str(value2)
			print ""
			pos = 0
			for top in topten:
				if len(used) == 40:
					used = []
					topten = sorted(topten, key=itemgetter(2))
				# print used
				# print pos
				if value2[1] > top[2] and pos not in used:
					# print key2
					# print auths_added
					if key2 not in auths_added and key2 not in ruled_out:
						topten[pos] = [key2,str(value2),value2[1], value]
						auths_added.append(key2)
						used.append(pos)
				pos += 1

for person in topten:
	print person